<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mermaid Test</title>
    <meta name="robots" content="noindex">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --container-max: 1000px;
        }
        body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; padding: 24px; background: #f5f7fb; color: #111827; }
        .container { max-width: var(--container-max); margin: 0 auto; }
        h1 { margin: 0 0 8px; font-size: 24px; }
        p { margin: 0 0 16px; color: #4b5563; }
        .card { background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 20px; margin: 16px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.04); }
        .mermaid-wrap { background:#fff; border:1px solid #e5e7eb; border-radius: 12px; padding: 16px; overflow: visible; }
        .mermaid { width: 100% !important; display: block !important; }
        .mermaid svg { width: 100% !important; height: auto !important; max-width: 100% !important; display: block !important; }
        .grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
        @media (min-width: 900px) { .grid { grid-template-columns: 1fr 1fr; } }
        .note { font-size: 12px; color:#6b7280; margin-top:8px; }
        .hr { height:1px; background:#e5e7eb; margin:16px 0; border:0; }
        code.inline { background:#eef2ff; color:#1f2937; padding:2px 6px; border-radius:4px; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.3.0/dist/mermaid.min.js"></script>
    <script>
        // Minimal, standalone initialization for testing
        mermaid.initialize({
            startOnLoad: true,
            fontSize: 16,
            securityLevel: 'loose',
            theme: 'base',
            flowchart: { useMaxWidth: true, htmlLabels: true }
        });
        // Safety: ensure width 100% after render
        window.addEventListener('load', function() {
            setTimeout(() => {
                document.querySelectorAll('.mermaid svg').forEach(svg => {
                    svg.removeAttribute('width');
                    svg.removeAttribute('height');
                    svg.style.width = '100%';
                    svg.style.height = 'auto';
                    svg.style.maxWidth = '100%';
                    if (!svg.getAttribute('preserveAspectRatio')) svg.setAttribute('preserveAspectRatio','xMidYMid meet');
                });
            }, 300);
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>Mermaid Rendering Test</h1>
        <p>Standalone page to validate Mermaid sizing and rendering. Open DevTools console for errors. Resize the window to test responsiveness.</p>

        <div class="card">
            <strong>Flowchart (LR)</strong>
            <div class="mermaid-wrap">
                <div class="mermaid">
flowchart LR
    A[Start] --> B{Condition}
    B -- Yes --> C[Do Something]
    B -- No  --> D[Do Another]
    C --> E[End]
    D --> E
                </div>
            </div>
            <div class="note">Expect full-width SVG within the white box. No clipping. Text readable.</div>
        </div>

        <div class="grid">
            <div class="card">
                <strong>Sequence Diagram</strong>
                <div class="mermaid-wrap">
                    <div class="mermaid">
sequenceDiagram
    participant U as User
    participant B as Boundary
    participant O as Operators
    participant I as Implementations

    U->>B: Request
    B->>O: DTO
    O->>I: Port Call
    I-->>O: Result
    O-->>B: Response
    B-->>U: Reply
                    </div>
                </div>
                <div class="note">Should scale to container and remain legible.</div>
            </div>

            <div class="card">
                <strong>Graph (TB) with Styling</strong>
                <div class="mermaid-wrap">
                    <div class="mermaid">
graph TB
    subgraph Core[Core Abstractions]
        E1[Entity]
        P1[Port]
    end
    subgraph Ops[Operators]
        S1[Use Case]
    end
    subgraph Impl[Implementations]
        A1[Adapter]
    end
    S1 --> P1
    A1 --> P1
    classDef core fill:#fff7ed,stroke:#c2410c,stroke-width:2px;
    classDef ops fill:#f0fdf4,stroke:#16a34a,stroke-width:2px;
    classDef impl fill:#fef3c7,stroke:#d97706,stroke-width:2px;
    class E1,P1 core;
    class S1 ops;
    class A1 impl;
                    </div>
                </div>
                <div class="note">Boxes should not overflow or get cut off.</div>
            </div>
        </div>

        <hr class="hr" />
        <p>If this page renders correctly but your docs page does not, the issue is likely CSS container constraints or double initialization. Compare with <code class="inline">.mermaid</code> container styles and any overflow rules.</p>
    </div>
</body>
</html>

