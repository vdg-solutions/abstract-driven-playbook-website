<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abstract Driven Development - Documentation</title>
    <meta name="description" content="Complete documentation for Abstract Driven Development (ADD) - a proven architecture pattern with AI assistance">
    <meta name="keywords" content="software architecture, clean architecture, dependency inversion, abstract driven development, ADD, design patterns, AI development, VIBE code, AI-assisted coding">

    <!-- Open Graph -->
    <meta property="og:title" content="Abstract Driven Development - Documentation">
    <meta property="og:description" content="Complete documentation for ADD - the first AI-centric architecture pattern">
    <meta property="og:type" content="website">

    <!-- Fonts - EXACT same as index.html -->
    <link href="lib/google-fonts.css" rel="stylesheet">

    <!-- Styles - EXACT same CSS files as index.html -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="lib/prism.min.css">

    <!-- Icons -->
    <link rel="stylesheet" href="lib/fontawesome.min.css">

    <!-- Mermaid - Local -->
    <script src="lib/mermaid.min.js"></script>

    <!-- Prism.js for syntax highlighting -->
    <script src="lib/prism.min.js"></script>
    <script src="lib/prism-typescript.min.js"></script>

    <!-- Additional documentation-specific styles -->
    <style>
        /* Documentation specific layout using existing design system */
        .docs-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: var(--space-3xl) var(--space-lg);
        }

        .docs-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: var(--space-3xl);
        }

        .docs-sidebar {
            position: sticky;
            top: 90px;
            height: fit-content;
            background: white;
            border-radius: 12px;
            padding: var(--space-xl);
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow-md);
        }

        .docs-sidebar h3 {
            margin: 0 0 var(--space-lg) 0;
            color: var(--gray-800);
            font-size: 1.1rem;
        }

        .docs-nav {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .docs-nav li {
            margin-bottom: 0.5rem;
        }

        .docs-nav a {
            display: block;
            padding: 0.5rem 0.75rem;
            color: var(--gray-600);
            text-decoration: none;
            border-radius: 6px;
            transition: var(--transition-normal);
            font-size: 0.9rem;
        }

        .docs-nav a:hover,
        .docs-nav a.active {
            background: rgba(2, 132, 199, 0.1);
            color: var(--primary-color);
        }

        .docs-content {
            background: white;
            border-radius: 12px;
            border: 1px solid var(--gray-200);
            box-shadow: var(--shadow-md);
            overflow: hidden;
        }

        .docs-section {
            padding: var(--space-2xl);
            border-bottom: 1px solid var(--gray-200);
        }

        .docs-section:last-child {
            border-bottom: none;
        }

        .docs-section h1 {
            margin: 0 0 var(--space-lg) 0;
            color: var(--gray-900);
            font-size: 2.5rem;
            font-weight: 700;
        }

        .docs-section h2 {
            margin: var(--space-2xl) 0 var(--space-lg) 0;
            color: var(--gray-800);
            font-size: 2rem;
            font-weight: 600;
        }

        .docs-section h3 {
            margin: var(--space-xl) 0 var(--space-lg) 0;
            color: var(--gray-700);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .docs-section p {
            margin-bottom: var(--space-lg);
            color: var(--gray-600);
            line-height: 1.7;
        }

        .docs-section ul,
        .docs-section ol {
            margin-bottom: var(--space-lg);
            color: var(--gray-600);
            padding-left: var(--space-lg);
        }

        .docs-section li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }

        /* Alerts using existing design system */
        .alert {
            padding: var(--space-lg);
            border-radius: 8px;
            margin: var(--space-lg) 0;
            border-left: 4px solid;
        }

        .alert-info {
            background: #eff6ff;
            border-left-color: var(--primary-color);
            color: #1e40af;
        }

        .alert-warning {
            background: #fffbeb;
            border-left-color: var(--warning-color);
            color: #92400e;
        }

        /* Working Mermaid styles - minimal and clean */
        .mermaid-diagram {
            margin: var(--space-xl) 0;
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: var(--space-xl);
            box-shadow: var(--shadow-sm);
        }

        .mermaid {
            width: 100% !important;
            display: block !important;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .mermaid:hover {
            transform: scale(1.02);
        }

        .mermaid svg {
            width: 100% !important;
            height: auto !important;
            max-width: 100% !important;
            display: block !important;
            margin: 0 auto;
        }

        /* Code blocks using existing system */
        .code-block {
            background: var(--gray-800);
            color: var(--gray-100);
            padding: var(--space-lg);
            border-radius: 8px;
            margin: var(--space-lg) 0;
            overflow-x: auto;
        }

        .code-block pre {
            margin: 0;
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Benefits using existing benefit-card style */
        .docs-benefits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-lg);
            margin: var(--space-xl) 0;
        }

        .docs-benefit {
            background: var(--gray-50);
            padding: var(--space-lg);
            border-radius: 12px;
            border: 1px solid var(--gray-200);
            transition: var(--transition-normal);
        }

        .docs-benefit:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .docs-benefit i {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: var(--space-lg);
        }

        .docs-benefit h4 {
            margin: 0 0 0.5rem 0;
            color: var(--gray-800);
            font-weight: 600;
        }

        .docs-benefit p {
            margin: 0;
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        /* Modal using existing design system */
        .diagram-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
        }

        .diagram-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .diagram-modal-content {
            background: white;
            border-radius: 12px;
            padding: var(--space-xl);
            max-width: 90vw;
            max-height: 90vh;
            overflow: auto;
            position: relative;
            box-shadow: var(--shadow-xl);
        }

        .diagram-close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--gray-100);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            color: var(--gray-600);
            transition: var(--transition-normal);
        }

        .diagram-close-btn:hover {
            background: var(--gray-200);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .docs-layout {
                grid-template-columns: 1fr;
                gap: var(--space-xl);
            }

            .docs-sidebar {
                position: static;
                order: 2;
            }
        }

        @media (max-width: 768px) {
            .docs-container {
                padding: var(--space-xl) var(--space-md);
            }

            .docs-section {
                padding: var(--space-xl);
            }

            .docs-section h1 {
                font-size: 2rem;
            }

            .docs-section h2 {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 640px) {
            .docs-container {
                padding: var(--space-lg) var(--space-sm);
            }
        }
    </style>
</head>
<body>
    <!-- Navigation - EXACT same as index.html -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="index.html">
                    <i class="fas fa-cube"></i>
                    <span>Abstract Driven</span>
                </a>
            </div>

            <div class="nav-menu" id="nav-menu">
                <ul class="nav-list">
                    <li><a href="index.html#overview" class="nav-link">Overview</a></li>
                    <li><a href="index.html#principles" class="nav-link">Principles</a></li>
                    <li><a href="index.html#patterns" class="nav-link">Patterns</a></li>
                    <li><a href="index.html#examples" class="nav-link">Examples</a></li>
                    <li><a href="documentation.html" class="nav-link active">Docs</a></li>
                </ul>
            </div>

            <div class="nav-toggle" id="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Main Documentation Content -->
    <div class="docs-container">
        <div class="docs-layout">
            <!-- Sidebar -->
            <aside class="docs-sidebar">
                <h3>Documentation</h3>
                <ul class="docs-nav">
                    <li><a href="#overview" class="active">Overview</a></li>
                    <li><a href="#architecture">5-Layer Architecture</a></li>
                    <li><a href="#reference-rules">Reference Rules</a></li>
                    <li><a href="#port-adapter">Port & Adapter</a></li>
                    <li><a href="#event-driven">Event-Driven</a></li>
                    <li><a href="#examples">Examples</a></li>
                </ul>
            </aside>

            <!-- Content -->
            <main class="docs-content">
                <!-- Overview Section -->
                <section id="overview" class="docs-section">
                    <h1>Abstract Driven Development (ADD)</h1>

                    <div class="alert alert-info">
                        <p><strong>The First AI-Centric Architecture:</strong> ADD enables AI to write complete software from start to finish, with human-in-the-loop control, solving the uncontrollable VIBE code problem while maintaining enterprise-grade quality.</p>
                    </div>

                    <p>Abstract Driven Development (ADD) is a software architecture pattern that emphasizes the separation of concerns through well-defined abstractions. It provides a systematic approach to building maintainable, testable, and scalable applications with AI assistance.</p>

                    <h2>Core Principles</h2>
                    <ul>
                        <li><strong>Abstraction First:</strong> Define interfaces before implementations</li>
                        <li><strong>Dependency Inversion:</strong> High-level modules should not depend on low-level modules</li>
                        <li><strong>Single Responsibility:</strong> Each layer has a clear, single purpose</li>
                        <li><strong>Testability:</strong> All components can be unit tested in isolation</li>
                        <li><strong>AI-Friendly:</strong> Structure enables AI to generate complete, maintainable code</li>
                    </ul>
                </section>

                <!-- Architecture Section -->
                <section id="architecture" class="docs-section">
                    <h1>5-Layer Architecture</h1>

                    <p>ADD organizes code into five distinct layers, each with specific responsibilities:</p>

                    <div class="docs-benefits">
                        <div class="docs-benefit">
                            <i class="fas fa-globe"></i>
                            <h4>Boundary Layer</h4>
                            <p>Handles external communication - DTOs, controllers, APIs, and system edges.</p>
                        </div>

                        <div class="docs-benefit">
                            <i class="fas fa-heart"></i>
                            <h4>Core Abstractions</h4>
                            <p>Defines entities, ports, and events - the heart of your domain model.</p>
                        </div>

                        <div class="docs-benefit">
                            <i class="fas fa-cogs"></i>
                            <h4>Operators Layer</h4>
                            <p>Contains business logic and use cases that orchestrate the domain.</p>
                        </div>

                        <div class="docs-benefit">
                            <i class="fas fa-plug"></i>
                            <h4>Implementations</h4>
                            <p>Concrete implementations of ports - adapters, repositories, external services.</p>
                        </div>

                        <div class="docs-benefit">
                            <i class="fas fa-rocket"></i>
                            <h4>Bootstrap Layer</h4>
                            <p>Application startup, dependency injection, and configuration wiring.</p>
                        </div>
                    </div>
                </section>

                <!-- Reference Rules Section -->
                <section id="reference-rules" class="docs-section">
                    <h1>Reference Rules Between Layers</h1>

                    <div class="mermaid-diagram">
                        <div class="mermaid">
flowchart BT
    S[Bootstrap Layer]
    O[Operators Layer]
    I[Implementations]
    B[Boundary Layer]
    C[Core Abstractions]

    O --> B
    O --> C
    I --> C
    S --> O
    S --> I

    style C fill:#fff7ed,stroke:#c2410c,stroke-width:2px
    style B fill:#eff6ff,stroke:#1d4ed8,stroke-width:2px
    style O fill:#f0fdf4,stroke:#16a34a,stroke-width:2px
    style I fill:#fef3c7,stroke:#d97706,stroke-width:2px
    style S fill:#f3e8ff,stroke:#9333ea,stroke-width:2px
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <p><strong>Critical Rule:</strong> No direct calls between Operators ↔ Implementations. Communication happens via:</p>
                        <ul>
                            <li>Interfaces declared in Core Abstractions (DI injects Implementation)</li>
                            <li>Internal events (Core Events)</li>
                        </ul>
                    </div>

                    <h2>Processing Flow</h2>

                    <div class="mermaid-diagram">
                        <div class="mermaid">
sequenceDiagram
    participant Ext as External System
    participant Boundary
    participant Operators
    participant Impl as Implementations

    Ext->>Boundary: Request DTO
    Boundary->>Operators: DTO
    Operators->>Impl: Call via interface
    Impl-->>Operators: Entity/Result
    Operators-->>Boundary: Response DTO
                        </div>
                    </div>
                </section>

                <!-- Port & Adapter Section -->
                <section id="port-adapter" class="docs-section">
                    <h1>Port & Adapter Pattern</h1>

                    <div class="alert alert-info">
                        <p><strong>Intent:</strong> Isolate business logic from external systems by defining clear interfaces (ports) and implementing adapters that handle technical integration details.</p>
                    </div>

                    <h2>Problem</h2>
                    <ul>
                        <li>Business logic gets coupled to specific technologies</li>
                        <li>Difficult to test business logic without external dependencies</li>
                        <li>Technology changes require modifications throughout the system</li>
                        <li>Different environments need different implementations</li>
                    </ul>

                    <h2>Solution</h2>
                    <p>Define abstract interfaces (ports) in Core Abstractions that express business needs, then implement concrete adapters in Implementations that handle the technical details.</p>

                    <div class="mermaid-diagram">
                        <div class="mermaid">
flowchart LR
    Operator[Operator] --> Port[Port Interface]
    Port -.-> Adapter1[PostgreSQL Adapter]
    Port -.-> Adapter2[MongoDB Adapter]
    Port -.-> Adapter3[In-Memory Adapter]

    Adapter1 --> DB[(PostgreSQL)]
    Adapter2 --> Mongo[(MongoDB)]
    Adapter3 --> Memory[Memory Store]

    style Port fill:#fff7ed,stroke:#c2410c,stroke-width:2px
    style Operator fill:#f0fdf4,stroke:#16a34a,stroke-width:2px
    style Adapter1 fill:#fef3c7,stroke:#d97706,stroke-width:2px
    style Adapter2 fill:#fef3c7,stroke:#d97706,stroke-width:2px
    style Adapter3 fill:#fef3c7,stroke:#d97706,stroke-width:2px
                        </div>
                    </div>
                </section>

                <!-- Event-Driven Section -->
                <section id="event-driven" class="docs-section">
                    <h1>Event-Driven Communication</h1>

                    <h2>Problem</h2>
                    <ul>
                        <li>Direct coupling between components creates rigid systems</li>
                        <li>Changes in one module require modifications in dependent modules</li>
                        <li>Difficult to add new functionality without modifying existing code</li>
                    </ul>

                    <h2>Solution</h2>
                    <p>Use events to communicate state changes and trigger side effects, with two distinct event types: <strong>Core Events</strong> for internal communication and <strong>Boundary Events</strong> for external integration.</p>

                    <div class="mermaid-diagram">
                        <div class="mermaid">
flowchart LR
    OpA[Operator A] --> EventBus[Event Bus]
    EventBus --> OpB[Operator B]
    OpB --> EventBus
    EventBus --> ExtSystem1[External System 1]
    EventBus --> ExtSystem2[External System 2]

    style OpA fill:#f0fdf4,stroke:#16a34a,stroke-width:2px
    style OpB fill:#f0fdf4,stroke:#16a34a,stroke-width:2px
    style EventBus fill:#fff7ed,stroke:#c2410c,stroke-width:2px
    style ExtSystem1 fill:#f3f4f6,stroke:#6b7280,stroke-width:2px
    style ExtSystem2 fill:#f3f4f6,stroke:#6b7280,stroke-width:2px
                        </div>
                    </div>
                </section>

                <!-- Examples Section -->
                <section id="examples" class="docs-section">
                    <h1>Implementation Examples</h1>

                    <h2>Port Definition (Core Abstractions)</h2>
                    <div class="code-block">
                        <pre><code>// core-abstractions/ports/user.repository.ts
export interface IUserRepository {
  save(user: User): Promise&lt;void&gt;;
  findById(id: UserId): Promise&lt;User | null&gt;;
  findByEmail(email: Email): Promise&lt;User | null&gt;;
  findActiveUsers(): Promise&lt;User[]&gt;;
}</code></pre>
                    </div>

                    <h2>Adapter Implementation</h2>
                    <div class="code-block">
                        <pre><code>// implementations/adapters/postgresql-user.repository.ts
export class PostgreSQLUserRepository implements IUserRepository {
  constructor(private db: Database) {}

  async save(user: User): Promise&lt;void&gt; {
    await this.db.query(
      'INSERT INTO users (id, email, name) VALUES ($1, $2, $3)',
      [user.id, user.email, user.name]
    );
  }

  async findById(id: UserId): Promise&lt;User | null&gt; {
    const result = await this.db.query(
      'SELECT * FROM users WHERE id = $1',
      [id]
    );
    return result.rows[0] ? User.fromRow(result.rows[0]) : null;
  }
}</code></pre>
                    </div>

                    <h2>Operator (Use Case)</h2>
                    <div class="code-block">
                        <pre><code>// operators/use-cases/create-user.operator.ts
export class CreateUserOperator {
  constructor(
    private userRepo: IUserRepository,
    private eventBus: IEventBus
  ) {}

  async execute(dto: CreateUserDTO): Promise&lt;CreateUserResponseDTO&gt; {
    const user = new User(dto.email, dto.name);

    await this.userRepo.save(user);

    await this.eventBus.publish(new UserCreatedEvent(user));

    return new CreateUserResponseDTO(user.id, user.email);
  }
}</code></pre>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Include main.js for navbar functionality -->
    <script src="js/main.js"></script>

    <script>
        // Let main.js handle everything - no duplication

        // Simple modal for diagram zoom
        function openDiagramModal(diagramElement) {
            const svg = diagramElement.querySelector('svg');
            if (!svg) return;

            let modal = document.getElementById('diagram-modal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'diagram-modal';
                modal.className = 'diagram-modal';
                modal.innerHTML = `
                    <div class="diagram-modal-content">
                        <button class="diagram-close-btn">×</button>
                    </div>
                `;
                document.body.appendChild(modal);

                modal.addEventListener('click', function(e) {
                    if (e.target === this || e.target.classList.contains('diagram-close-btn')) {
                        this.classList.remove('active');
                    }
                });
            }

            const modalContent = modal.querySelector('.diagram-modal-content');
            const clonedSvg = svg.cloneNode(true);

            // Clear previous content except close button
            const closeBtn = modalContent.querySelector('.diagram-close-btn');
            modalContent.innerHTML = '';
            modalContent.appendChild(closeBtn);
            modalContent.appendChild(clonedSvg);

            modal.classList.add('active');
        }

        // Documentation navigation
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarLinks = document.querySelectorAll('.docs-nav a');
            const sections = document.querySelectorAll('.docs-section');

            // Update active link on scroll
            function updateActiveLink() {
                let current = '';
                sections.forEach(section => {
                    const rect = section.getBoundingClientRect();
                    if (rect.top <= 100 && rect.bottom >= 100) {
                        current = section.id;
                    }
                });

                sidebarLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${current}`) {
                        link.classList.add('active');
                    }
                });
            }

            window.addEventListener('scroll', updateActiveLink);

            // Handle sidebar clicks
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);

                    if (targetElement) {
                        const headerOffset = 100;
                        const elementPosition = targetElement.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });

                        sidebarLinks.forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                    }
                });
            });
        });
    </script>
</body>
</html>